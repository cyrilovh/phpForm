RewriteEngine on

# REWRITE ASSETS
RewriteCond %{REQUEST_URI} ^/assets [OR]
RewriteCond %{REQUEST_URI} ^/ressources
RewriteRule ^(.*)$ /public/$1 [NC,L]

# ACCESS TO /page IS INCORRECT
RewriteCond %{REQUEST_URI} ^/page
RewriteRule ^(.*)$ /public/index.php?page=404 [NC,L]

#ROUTER
# /toto -> index.php?page=toto
RewriteCond %{REQUEST_URI} !^/public/
RewriteCond %{REQUEST_URI} !^/robots.txt
RewriteCond %{REQUEST_URI} !^/tests/
RewriteRule ^(.*)$ /public/index.php?page=$1&%{QUERY_STRING} [NC]

# /toto/1 -> index.php?page=toto&id=1
RewriteCond %{REQUEST_URI} !^/public/
RewriteCond %{REQUEST_URI} !^/robots.txt
RewriteCond %{REQUEST_URI} !^/tests/
RewriteRule ^(.*)/(.*)$ /public/index.php?page=$1&id=$2&%{QUERY_STRING} [NC]

# PHOTOS PROTECTED ACCESS
RewriteCond %{REQUEST_URI} ^/picture/
RewriteRule ^(.*)/(.*)/(.*)$ /public/photo.php?name=$3&%{QUERY_STRING} [NC,L]

# CAPTCHA
RewriteCond %{REQUEST_URI} ^/captcha
RewriteRule ^(.*)$ /public/captcha.php [NC,L]

<Files .htaccess>
    order allow,deny
    deny from all
</Files>